% Giả sử các giá trị cụ thể
p_x_old = 1;
p_y_old = 2;
p_z_old = 3;

p_x = 9;
p_y = 11;
p_z = 12;

% Tính các điểm trung bình
p_x_mid = abs(p_x - p_x_old) / 2;
p_y_mid = abs(p_y + p_y_old) / 2;
p_z_mid = abs(p_z - p_z_old) / 2;

p3 = [p_x, p_y, p_z];
p1 = [p_x_old, p_y_old, p_z_old];
p2 = [p_x_mid, p_y_mid, p_z_mid];

% Caculate radius:
a = norm(p2 - p3)^2;
b = norm(p1 - p3)^2;
c = norm(p1 - p2)^2;

% Tính bán kính và tâm của đường tròn
s = (a + b + c) / 2; % Half circumference
R_cir = (a * b * c) / (4 * sqrt(s * (s - a) * (s - b) * (s - c)));
N = a * (b + c - a) + b * (c + a - b) + c * (a + b - c);
D = 2 * (a * (b + c - a) * p1 + b * (c + a - b) * p2 + c * (a + b - c) * p3);
O_cir = D / N;

% Hiển thị các điểm p và O_cir trong không gian
figure;
plot3([p_x_old, p_x], [p_y_old, p_y], [p_z_old, p_z], '-o');
hold on;
scatter3(p_x_old, p_y_old, p_z_old, 'filled', 'MarkerFaceColor', 'r', 'MarkerEdgeColor', 'r');
scatter3(p_x, p_y, p_z, 'filled', 'MarkerFaceColor', 'r', 'MarkerEdgeColor', 'r');
scatter3(p_x_mid, p_y_mid, p_z_mid, 'filled', 'MarkerFaceColor', 'b', 'MarkerEdgeColor', 'b');
scatter3(O_cir(1), O_cir(2), O_cir(3), 'filled', 'MarkerFaceColor', 'g', 'MarkerEdgeColor', 'g');
grid on;
xlabel('X-axis');
ylabel('Y-axis');
zlabel('Z-axis');
title('Circle Trajectory with Start and End Points');